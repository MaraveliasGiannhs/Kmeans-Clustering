using System;
using System.IO;
using OfficeOpenXml;

class Program
{
    static void Main(string[] args)
    {
        // Path to the Excel file
        string filePath = "C:\\Users\\giann\\OneDrive\\Desktop\\Book (1).xlsx";
        K_MeansAlgorithm kMeansAlgo = new K_MeansAlgorithm();


        // Check if the file exists
        if (!File.Exists(filePath))
        {
            Console.WriteLine("The Excel file does not exist.");
            return;
        }

        Person[] person = new Person[10];
        for (int i = 0; i < person.Length; i++)
            person[i] = new Person(0, 0);

        // Read data from the Excel file
        try
        {
            using (ExcelPackage package = new ExcelPackage(new FileInfo(filePath)))
            {
                // Get the first worksheet in the Excel file
                ExcelWorksheet worksheet = package.Workbook.Worksheets[0];

                // Get the number of rows and columns in the worksheet
                int rowCount = worksheet.Dimension.Rows;
                int colCount = worksheet.Dimension.Columns;

                

                // Read data from the worksheet
                for (int row = 1; row <= rowCount; row++)
                {
                    for (int col = 1; col <= colCount; col++)
                    {

                        // Get the value at the current cell
                        object cell = worksheet.Cells[row, col].Value;

                        //Convert to double
                        double cellValue = Convert.ToDouble(cell);

                        //Assign it to person's data
                        if (row == 1)
                        {
                            
                            person[col-1].SetAge(cellValue);
                        }
                        else
                        {
                            person[col - 1].SetIncome(cellValue);

                            //Pass each person's data to the algorithm
                            kMeansAlgo.AssignDataFromPerson(person[col - 1].age, person[col -1].income, col - 1);
                        }
                        // Print the cell value
                        Console.Write(person[col-1].income + "\t");
                    }

                    Console.WriteLine();
                }
                kMeansAlgo.Init();

                

            }
        }
        catch (Exception ex)
        {
            Console.WriteLine("An error occurred while reading the Excel file: " + ex.Message);
        }
    }
}
