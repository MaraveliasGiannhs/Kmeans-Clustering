using System;
using System.IO;
using OfficeOpenXml;

class Program
{
    static void Main(string[] args)
    {
        // Path to the Excel file
        string filePath = "C:\\Users\\giann\\OneDrive\\Desktop\\Book (1).xlsx";

        // Check if the file exists
        if (!File.Exists(filePath))
        {
            Console.WriteLine("The Excel file does not exist.");
            return;
        }

        // Read data from the Excel file
        try
        {
            using (ExcelPackage package = new ExcelPackage(new FileInfo(filePath)))
            {
                // Get the first worksheet in the Excel file
                ExcelWorksheet worksheet = package.Workbook.Worksheets[0];

                // Get the number of rows and columns in the worksheet
                int rowCount = worksheet.Dimension.Rows;
                int colCount = worksheet.Dimension.Columns;

                Person[] person = new Person[10];


                // Read data from the worksheet
                for (int row = 1; row <= rowCount; row++)
                {

                    for (int col = 1; col <= colCount; col++)
                    {
                        // Get the value at the current cell
                        object cellValue = worksheet.Cells[row, col].Value;
                        person[col] = new Person(cellValue);

                        // Print the cell value
                        Console.Write(person[col].income + "\t");
                    }
                    Console.WriteLine();
                }
            }



        }
        catch (Exception ex)
        {
            Console.WriteLine("An error occurred while reading the Excel file: " + ex.Message);
        }
    }
}
